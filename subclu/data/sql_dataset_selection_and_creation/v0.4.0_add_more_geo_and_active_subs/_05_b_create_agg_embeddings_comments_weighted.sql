-- NOTE: this query runs out of memory in BigQuery
--  So instead, maybe try AVG (unweighted mean) for comments
--    because we have so many more comments
--    we still need weighted avg at post level, but there we only have 8 million rows
--     instead of 40 million comments.
-- Get weighted mean, use CTE to split up logic for creating weights
--  and prevent errors from (get aggregation of aggregations)
DECLARE subreddit_rank_min NUMERIC DEFAULT 1;
DECLARE subreddit_rank_max NUMERIC DEFAULT 5000;

CREATE OR REPLACE TABLE `reddit-employee-datasets.david_bermejo.subclu_v0040_embeddings_agg_comments_to_post_level_weight_by_upvotes_0`
AS (
    WITH
    selected_subreddits AS (
        SELECT subreddit_id
        FROM (
            SELECT
                subreddit_id
                , ROW_NUMBER() OVER (PARTITION BY subreddit_id) AS row_subreddit_id
            FROM `reddit-employee-datasets.david_bermejo.subclu_subreddits_top_no_geo_20210924`
        )
        WHERE 1=1
            AND subreddit_rank_min <= row_subreddit_id
            AND row_subreddit_id < subreddit_rank_max
    ),

    weights_for_mean AS (
        SELECT
            cem.post_id
            , cem.comment_id
            , LN(3 + COALESCE(upvotes, 1)) AS ln_upvotes

        FROM `reddit-employee-datasets.david_bermejo.subclu_v0040_embeddings_comments` AS cem
        -- INNER JOIN for selected subs b/c we want to only keep comments for selected subs
        INNER JOIN selected_subreddits AS ss
            ON cem.subreddit_id = ss.subreddit_id
        -- Let's go with LEFT join and coalesce in case we don't have weights
        LEFT JOIN `reddit-employee-datasets.david_bermejo.subclu_comments_top_no_geo_20211004` AS cm
            ON cem.comment_id = cm.comment_id
    )

    SELECT
        cem.subreddit_id
        , cem.post_id
        -- these cols can be good for debugging/testing, but not needed in final table
        -- , COUNT(cem.comment_id)  AS comment_id_count
        -- , SUM(ln_upvotes) AS ln_upvotes_sum

        , (SUM(embeddings_0 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_0
        , (SUM(embeddings_1 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_1
        , (SUM(embeddings_2 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_2
        , (SUM(embeddings_3 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_3
        , (SUM(embeddings_4 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_4
        , (SUM(embeddings_5 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_5
        , (SUM(embeddings_6 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_6
        , (SUM(embeddings_7 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_7
        , (SUM(embeddings_8 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_8
        , (SUM(embeddings_9 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_9
        , (SUM(embeddings_10 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_10
        , (SUM(embeddings_11 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_11
        , (SUM(embeddings_12 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_12
        , (SUM(embeddings_13 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_13
        , (SUM(embeddings_14 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_14
        , (SUM(embeddings_15 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_15
        , (SUM(embeddings_16 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_16
        , (SUM(embeddings_17 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_17
        , (SUM(embeddings_18 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_18
        , (SUM(embeddings_19 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_19
        , (SUM(embeddings_20 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_20
        , (SUM(embeddings_21 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_21
        , (SUM(embeddings_22 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_22
        , (SUM(embeddings_23 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_23
        , (SUM(embeddings_24 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_24
        , (SUM(embeddings_25 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_25
        , (SUM(embeddings_26 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_26
        , (SUM(embeddings_27 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_27
        , (SUM(embeddings_28 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_28
        , (SUM(embeddings_29 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_29
        , (SUM(embeddings_30 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_30
        , (SUM(embeddings_31 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_31
        , (SUM(embeddings_32 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_32
        , (SUM(embeddings_33 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_33
        , (SUM(embeddings_34 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_34
        , (SUM(embeddings_35 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_35
        , (SUM(embeddings_36 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_36
        , (SUM(embeddings_37 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_37
        , (SUM(embeddings_38 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_38
        , (SUM(embeddings_39 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_39
        , (SUM(embeddings_40 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_40
        , (SUM(embeddings_41 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_41
        , (SUM(embeddings_42 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_42
        , (SUM(embeddings_43 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_43
        , (SUM(embeddings_44 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_44
        , (SUM(embeddings_45 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_45
        , (SUM(embeddings_46 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_46
        , (SUM(embeddings_47 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_47
        , (SUM(embeddings_48 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_48
        , (SUM(embeddings_49 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_49
        , (SUM(embeddings_50 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_50
        , (SUM(embeddings_51 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_51
        , (SUM(embeddings_52 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_52
        , (SUM(embeddings_53 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_53
        , (SUM(embeddings_54 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_54
        , (SUM(embeddings_55 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_55
        , (SUM(embeddings_56 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_56
        , (SUM(embeddings_57 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_57
        , (SUM(embeddings_58 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_58
        , (SUM(embeddings_59 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_59
        , (SUM(embeddings_60 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_60
        , (SUM(embeddings_61 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_61
        , (SUM(embeddings_62 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_62
        , (SUM(embeddings_63 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_63
        , (SUM(embeddings_64 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_64
        , (SUM(embeddings_65 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_65
        , (SUM(embeddings_66 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_66
        , (SUM(embeddings_67 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_67
        , (SUM(embeddings_68 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_68
        , (SUM(embeddings_69 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_69
        , (SUM(embeddings_70 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_70
        , (SUM(embeddings_71 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_71
        , (SUM(embeddings_72 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_72
        , (SUM(embeddings_73 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_73
        , (SUM(embeddings_74 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_74
        , (SUM(embeddings_75 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_75
        , (SUM(embeddings_76 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_76
        , (SUM(embeddings_77 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_77
        , (SUM(embeddings_78 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_78
        , (SUM(embeddings_79 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_79
        , (SUM(embeddings_80 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_80
        , (SUM(embeddings_81 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_81
        , (SUM(embeddings_82 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_82
        , (SUM(embeddings_83 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_83
        , (SUM(embeddings_84 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_84
        , (SUM(embeddings_85 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_85
        , (SUM(embeddings_86 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_86
        , (SUM(embeddings_87 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_87
        , (SUM(embeddings_88 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_88
        , (SUM(embeddings_89 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_89
        , (SUM(embeddings_90 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_90
        , (SUM(embeddings_91 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_91
        , (SUM(embeddings_92 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_92
        , (SUM(embeddings_93 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_93
        , (SUM(embeddings_94 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_94
        , (SUM(embeddings_95 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_95
        , (SUM(embeddings_96 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_96
        , (SUM(embeddings_97 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_97
        , (SUM(embeddings_98 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_98
        , (SUM(embeddings_99 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_99
        , (SUM(embeddings_100 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_100
        , (SUM(embeddings_101 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_101
        , (SUM(embeddings_102 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_102
        , (SUM(embeddings_103 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_103
        , (SUM(embeddings_104 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_104
        , (SUM(embeddings_105 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_105
        , (SUM(embeddings_106 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_106
        , (SUM(embeddings_107 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_107
        , (SUM(embeddings_108 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_108
        , (SUM(embeddings_109 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_109
        , (SUM(embeddings_110 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_110
        , (SUM(embeddings_111 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_111
        , (SUM(embeddings_112 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_112
        , (SUM(embeddings_113 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_113
        , (SUM(embeddings_114 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_114
        , (SUM(embeddings_115 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_115
        , (SUM(embeddings_116 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_116
        , (SUM(embeddings_117 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_117
        , (SUM(embeddings_118 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_118
        , (SUM(embeddings_119 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_119
        , (SUM(embeddings_120 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_120
        , (SUM(embeddings_121 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_121
        , (SUM(embeddings_122 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_122
        , (SUM(embeddings_123 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_123
        , (SUM(embeddings_124 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_124
        , (SUM(embeddings_125 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_125
        , (SUM(embeddings_126 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_126
        , (SUM(embeddings_127 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_127
        , (SUM(embeddings_128 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_128
        , (SUM(embeddings_129 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_129
        , (SUM(embeddings_130 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_130
        , (SUM(embeddings_131 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_131
        , (SUM(embeddings_132 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_132
        , (SUM(embeddings_133 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_133
        , (SUM(embeddings_134 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_134
        , (SUM(embeddings_135 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_135
        , (SUM(embeddings_136 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_136
        , (SUM(embeddings_137 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_137
        , (SUM(embeddings_138 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_138
        , (SUM(embeddings_139 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_139
        , (SUM(embeddings_140 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_140
        , (SUM(embeddings_141 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_141
        , (SUM(embeddings_142 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_142
        , (SUM(embeddings_143 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_143
        , (SUM(embeddings_144 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_144
        , (SUM(embeddings_145 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_145
        , (SUM(embeddings_146 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_146
        , (SUM(embeddings_147 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_147
        , (SUM(embeddings_148 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_148
        , (SUM(embeddings_149 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_149
        , (SUM(embeddings_150 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_150
        , (SUM(embeddings_151 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_151
        , (SUM(embeddings_152 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_152
        , (SUM(embeddings_153 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_153
        , (SUM(embeddings_154 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_154
        , (SUM(embeddings_155 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_155
        , (SUM(embeddings_156 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_156
        , (SUM(embeddings_157 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_157
        , (SUM(embeddings_158 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_158
        , (SUM(embeddings_159 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_159
        , (SUM(embeddings_160 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_160
        , (SUM(embeddings_161 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_161
        , (SUM(embeddings_162 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_162
        , (SUM(embeddings_163 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_163
        , (SUM(embeddings_164 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_164
        , (SUM(embeddings_165 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_165
        , (SUM(embeddings_166 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_166
        , (SUM(embeddings_167 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_167
        , (SUM(embeddings_168 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_168
        , (SUM(embeddings_169 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_169
        , (SUM(embeddings_170 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_170
        , (SUM(embeddings_171 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_171
        , (SUM(embeddings_172 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_172
        , (SUM(embeddings_173 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_173
        , (SUM(embeddings_174 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_174
        , (SUM(embeddings_175 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_175
        , (SUM(embeddings_176 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_176
        , (SUM(embeddings_177 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_177
        , (SUM(embeddings_178 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_178
        , (SUM(embeddings_179 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_179
        , (SUM(embeddings_180 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_180
        , (SUM(embeddings_181 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_181
        , (SUM(embeddings_182 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_182
        , (SUM(embeddings_183 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_183
        , (SUM(embeddings_184 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_184
        , (SUM(embeddings_185 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_185
        , (SUM(embeddings_186 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_186
        , (SUM(embeddings_187 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_187
        , (SUM(embeddings_188 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_188
        , (SUM(embeddings_189 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_189
        , (SUM(embeddings_190 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_190
        , (SUM(embeddings_191 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_191
        , (SUM(embeddings_192 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_192
        , (SUM(embeddings_193 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_193
        , (SUM(embeddings_194 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_194
        , (SUM(embeddings_195 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_195
        , (SUM(embeddings_196 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_196
        , (SUM(embeddings_197 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_197
        , (SUM(embeddings_198 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_198
        , (SUM(embeddings_199 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_199
        , (SUM(embeddings_200 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_200
        , (SUM(embeddings_201 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_201
        , (SUM(embeddings_202 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_202
        , (SUM(embeddings_203 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_203
        , (SUM(embeddings_204 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_204
        , (SUM(embeddings_205 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_205
        , (SUM(embeddings_206 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_206
        , (SUM(embeddings_207 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_207
        , (SUM(embeddings_208 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_208
        , (SUM(embeddings_209 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_209
        , (SUM(embeddings_210 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_210
        , (SUM(embeddings_211 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_211
        , (SUM(embeddings_212 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_212
        , (SUM(embeddings_213 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_213
        , (SUM(embeddings_214 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_214
        , (SUM(embeddings_215 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_215
        , (SUM(embeddings_216 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_216
        , (SUM(embeddings_217 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_217
        , (SUM(embeddings_218 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_218
        , (SUM(embeddings_219 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_219
        , (SUM(embeddings_220 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_220
        , (SUM(embeddings_221 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_221
        , (SUM(embeddings_222 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_222
        , (SUM(embeddings_223 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_223
        , (SUM(embeddings_224 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_224
        , (SUM(embeddings_225 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_225
        , (SUM(embeddings_226 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_226
        , (SUM(embeddings_227 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_227
        , (SUM(embeddings_228 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_228
        , (SUM(embeddings_229 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_229
        , (SUM(embeddings_230 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_230
        , (SUM(embeddings_231 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_231
        , (SUM(embeddings_232 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_232
        , (SUM(embeddings_233 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_233
        , (SUM(embeddings_234 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_234
        , (SUM(embeddings_235 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_235
        , (SUM(embeddings_236 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_236
        , (SUM(embeddings_237 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_237
        , (SUM(embeddings_238 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_238
        , (SUM(embeddings_239 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_239
        , (SUM(embeddings_240 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_240
        , (SUM(embeddings_241 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_241
        , (SUM(embeddings_242 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_242
        , (SUM(embeddings_243 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_243
        , (SUM(embeddings_244 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_244
        , (SUM(embeddings_245 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_245
        , (SUM(embeddings_246 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_246
        , (SUM(embeddings_247 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_247
        , (SUM(embeddings_248 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_248
        , (SUM(embeddings_249 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_249
        , (SUM(embeddings_250 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_250
        , (SUM(embeddings_251 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_251
        , (SUM(embeddings_252 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_252
        , (SUM(embeddings_253 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_253
        , (SUM(embeddings_254 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_254
        , (SUM(embeddings_255 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_255
        , (SUM(embeddings_256 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_256
        , (SUM(embeddings_257 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_257
        , (SUM(embeddings_258 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_258
        , (SUM(embeddings_259 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_259
        , (SUM(embeddings_260 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_260
        , (SUM(embeddings_261 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_261
        , (SUM(embeddings_262 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_262
        , (SUM(embeddings_263 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_263
        , (SUM(embeddings_264 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_264
        , (SUM(embeddings_265 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_265
        , (SUM(embeddings_266 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_266
        , (SUM(embeddings_267 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_267
        , (SUM(embeddings_268 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_268
        , (SUM(embeddings_269 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_269
        , (SUM(embeddings_270 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_270
        , (SUM(embeddings_271 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_271
        , (SUM(embeddings_272 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_272
        , (SUM(embeddings_273 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_273
        , (SUM(embeddings_274 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_274
        , (SUM(embeddings_275 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_275
        , (SUM(embeddings_276 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_276
        , (SUM(embeddings_277 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_277
        , (SUM(embeddings_278 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_278
        , (SUM(embeddings_279 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_279
        , (SUM(embeddings_280 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_280
        , (SUM(embeddings_281 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_281
        , (SUM(embeddings_282 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_282
        , (SUM(embeddings_283 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_283
        , (SUM(embeddings_284 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_284
        , (SUM(embeddings_285 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_285
        , (SUM(embeddings_286 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_286
        , (SUM(embeddings_287 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_287
        , (SUM(embeddings_288 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_288
        , (SUM(embeddings_289 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_289
        , (SUM(embeddings_290 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_290
        , (SUM(embeddings_291 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_291
        , (SUM(embeddings_292 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_292
        , (SUM(embeddings_293 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_293
        , (SUM(embeddings_294 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_294
        , (SUM(embeddings_295 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_295
        , (SUM(embeddings_296 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_296
        , (SUM(embeddings_297 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_297
        , (SUM(embeddings_298 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_298
        , (SUM(embeddings_299 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_299
        , (SUM(embeddings_300 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_300
        , (SUM(embeddings_301 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_301
        , (SUM(embeddings_302 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_302
        , (SUM(embeddings_303 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_303
        , (SUM(embeddings_304 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_304
        , (SUM(embeddings_305 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_305
        , (SUM(embeddings_306 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_306
        , (SUM(embeddings_307 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_307
        , (SUM(embeddings_308 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_308
        , (SUM(embeddings_309 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_309
        , (SUM(embeddings_310 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_310
        , (SUM(embeddings_311 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_311
        , (SUM(embeddings_312 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_312
        , (SUM(embeddings_313 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_313
        , (SUM(embeddings_314 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_314
        , (SUM(embeddings_315 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_315
        , (SUM(embeddings_316 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_316
        , (SUM(embeddings_317 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_317
        , (SUM(embeddings_318 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_318
        , (SUM(embeddings_319 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_319
        , (SUM(embeddings_320 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_320
        , (SUM(embeddings_321 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_321
        , (SUM(embeddings_322 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_322
        , (SUM(embeddings_323 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_323
        , (SUM(embeddings_324 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_324
        , (SUM(embeddings_325 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_325
        , (SUM(embeddings_326 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_326
        , (SUM(embeddings_327 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_327
        , (SUM(embeddings_328 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_328
        , (SUM(embeddings_329 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_329
        , (SUM(embeddings_330 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_330
        , (SUM(embeddings_331 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_331
        , (SUM(embeddings_332 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_332
        , (SUM(embeddings_333 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_333
        , (SUM(embeddings_334 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_334
        , (SUM(embeddings_335 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_335
        , (SUM(embeddings_336 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_336
        , (SUM(embeddings_337 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_337
        , (SUM(embeddings_338 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_338
        , (SUM(embeddings_339 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_339
        , (SUM(embeddings_340 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_340
        , (SUM(embeddings_341 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_341
        , (SUM(embeddings_342 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_342
        , (SUM(embeddings_343 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_343
        , (SUM(embeddings_344 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_344
        , (SUM(embeddings_345 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_345
        , (SUM(embeddings_346 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_346
        , (SUM(embeddings_347 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_347
        , (SUM(embeddings_348 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_348
        , (SUM(embeddings_349 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_349
        , (SUM(embeddings_350 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_350
        , (SUM(embeddings_351 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_351
        , (SUM(embeddings_352 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_352
        , (SUM(embeddings_353 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_353
        , (SUM(embeddings_354 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_354
        , (SUM(embeddings_355 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_355
        , (SUM(embeddings_356 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_356
        , (SUM(embeddings_357 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_357
        , (SUM(embeddings_358 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_358
        , (SUM(embeddings_359 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_359
        , (SUM(embeddings_360 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_360
        , (SUM(embeddings_361 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_361
        , (SUM(embeddings_362 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_362
        , (SUM(embeddings_363 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_363
        , (SUM(embeddings_364 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_364
        , (SUM(embeddings_365 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_365
        , (SUM(embeddings_366 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_366
        , (SUM(embeddings_367 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_367
        , (SUM(embeddings_368 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_368
        , (SUM(embeddings_369 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_369
        , (SUM(embeddings_370 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_370
        , (SUM(embeddings_371 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_371
        , (SUM(embeddings_372 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_372
        , (SUM(embeddings_373 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_373
        , (SUM(embeddings_374 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_374
        , (SUM(embeddings_375 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_375
        , (SUM(embeddings_376 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_376
        , (SUM(embeddings_377 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_377
        , (SUM(embeddings_378 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_378
        , (SUM(embeddings_379 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_379
        , (SUM(embeddings_380 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_380
        , (SUM(embeddings_381 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_381
        , (SUM(embeddings_382 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_382
        , (SUM(embeddings_383 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_383
        , (SUM(embeddings_384 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_384
        , (SUM(embeddings_385 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_385
        , (SUM(embeddings_386 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_386
        , (SUM(embeddings_387 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_387
        , (SUM(embeddings_388 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_388
        , (SUM(embeddings_389 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_389
        , (SUM(embeddings_390 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_390
        , (SUM(embeddings_391 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_391
        , (SUM(embeddings_392 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_392
        , (SUM(embeddings_393 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_393
        , (SUM(embeddings_394 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_394
        , (SUM(embeddings_395 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_395
        , (SUM(embeddings_396 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_396
        , (SUM(embeddings_397 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_397
        , (SUM(embeddings_398 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_398
        , (SUM(embeddings_399 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_399
        , (SUM(embeddings_400 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_400
        , (SUM(embeddings_401 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_401
        , (SUM(embeddings_402 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_402
        , (SUM(embeddings_403 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_403
        , (SUM(embeddings_404 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_404
        , (SUM(embeddings_405 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_405
        , (SUM(embeddings_406 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_406
        , (SUM(embeddings_407 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_407
        , (SUM(embeddings_408 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_408
        , (SUM(embeddings_409 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_409
        , (SUM(embeddings_410 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_410
        , (SUM(embeddings_411 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_411
        , (SUM(embeddings_412 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_412
        , (SUM(embeddings_413 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_413
        , (SUM(embeddings_414 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_414
        , (SUM(embeddings_415 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_415
        , (SUM(embeddings_416 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_416
        , (SUM(embeddings_417 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_417
        , (SUM(embeddings_418 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_418
        , (SUM(embeddings_419 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_419
        , (SUM(embeddings_420 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_420
        , (SUM(embeddings_421 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_421
        , (SUM(embeddings_422 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_422
        , (SUM(embeddings_423 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_423
        , (SUM(embeddings_424 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_424
        , (SUM(embeddings_425 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_425
        , (SUM(embeddings_426 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_426
        , (SUM(embeddings_427 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_427
        , (SUM(embeddings_428 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_428
        , (SUM(embeddings_429 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_429
        , (SUM(embeddings_430 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_430
        , (SUM(embeddings_431 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_431
        , (SUM(embeddings_432 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_432
        , (SUM(embeddings_433 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_433
        , (SUM(embeddings_434 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_434
        , (SUM(embeddings_435 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_435
        , (SUM(embeddings_436 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_436
        , (SUM(embeddings_437 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_437
        , (SUM(embeddings_438 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_438
        , (SUM(embeddings_439 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_439
        , (SUM(embeddings_440 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_440
        , (SUM(embeddings_441 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_441
        , (SUM(embeddings_442 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_442
        , (SUM(embeddings_443 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_443
        , (SUM(embeddings_444 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_444
        , (SUM(embeddings_445 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_445
        , (SUM(embeddings_446 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_446
        , (SUM(embeddings_447 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_447
        , (SUM(embeddings_448 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_448
        , (SUM(embeddings_449 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_449
        , (SUM(embeddings_450 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_450
        , (SUM(embeddings_451 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_451
        , (SUM(embeddings_452 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_452
        , (SUM(embeddings_453 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_453
        , (SUM(embeddings_454 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_454
        , (SUM(embeddings_455 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_455
        , (SUM(embeddings_456 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_456
        , (SUM(embeddings_457 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_457
        , (SUM(embeddings_458 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_458
        , (SUM(embeddings_459 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_459
        , (SUM(embeddings_460 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_460
        , (SUM(embeddings_461 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_461
        , (SUM(embeddings_462 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_462
        , (SUM(embeddings_463 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_463
        , (SUM(embeddings_464 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_464
        , (SUM(embeddings_465 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_465
        , (SUM(embeddings_466 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_466
        , (SUM(embeddings_467 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_467
        , (SUM(embeddings_468 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_468
        , (SUM(embeddings_469 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_469
        , (SUM(embeddings_470 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_470
        , (SUM(embeddings_471 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_471
        , (SUM(embeddings_472 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_472
        , (SUM(embeddings_473 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_473
        , (SUM(embeddings_474 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_474
        , (SUM(embeddings_475 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_475
        , (SUM(embeddings_476 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_476
        , (SUM(embeddings_477 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_477
        , (SUM(embeddings_478 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_478
        , (SUM(embeddings_479 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_479
        , (SUM(embeddings_480 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_480
        , (SUM(embeddings_481 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_481
        , (SUM(embeddings_482 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_482
        , (SUM(embeddings_483 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_483
        , (SUM(embeddings_484 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_484
        , (SUM(embeddings_485 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_485
        , (SUM(embeddings_486 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_486
        , (SUM(embeddings_487 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_487
        , (SUM(embeddings_488 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_488
        , (SUM(embeddings_489 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_489
        , (SUM(embeddings_490 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_490
        , (SUM(embeddings_491 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_491
        , (SUM(embeddings_492 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_492
        , (SUM(embeddings_493 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_493
        , (SUM(embeddings_494 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_494
        , (SUM(embeddings_495 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_495
        , (SUM(embeddings_496 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_496
        , (SUM(embeddings_497 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_497
        , (SUM(embeddings_498 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_498
        , (SUM(embeddings_499 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_499
        , (SUM(embeddings_500 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_500
        , (SUM(embeddings_501 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_501
        , (SUM(embeddings_502 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_502
        , (SUM(embeddings_503 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_503
        , (SUM(embeddings_504 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_504
        , (SUM(embeddings_505 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_505
        , (SUM(embeddings_506 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_506
        , (SUM(embeddings_507 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_507
        , (SUM(embeddings_508 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_508
        , (SUM(embeddings_509 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_509
        , (SUM(embeddings_510 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_510
        , (SUM(embeddings_511 * ln_upvotes) / SUM(ln_upvotes) )  AS embeddings_511

    FROM `reddit-employee-datasets.david_bermejo.subclu_v0040_embeddings_comments` AS cem
    LEFT JOIN weights_for_mean AS w
        ON cem.comment_id = w.comment_id

    GROUP BY 1, 2
    ORDER BY 1, 2
); -- close CREATE TABLE statment
